# üì° –û–ü–ò–° –†–ï–ê–õ–Ü–ó–ê–¶–Ü–á –°–ï–†–í–ï–†–ê –¢–ê –ö–õ–Ü–Ñ–ù–¢–ê

## üèóÔ∏è –ê–†–•–Ü–¢–ï–ö–¢–£–†–ê

–ü—Ä–æ—î–∫—Ç –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î **Bluetooth Low Energy (BLE)** –¥–ª—è –ø–µ—Ä–µ–¥–∞—á—ñ –¥–∞–Ω–∏—Ö —Å–µ–Ω—Å–æ—Ä—ñ–≤ –º—ñ–∂ –¥–≤–æ–º–∞ –ø—Ä–∏—Å—Ç—Ä–æ—è–º–∏:

- **–°–ï–†–í–ï–†** - –≤—ñ–¥–ø—Ä–∞–≤–ª—è—î –¥–∞–Ω—ñ –∑ –∞–∫—Å–µ–ª–µ—Ä–æ–º–µ—Ç—Ä–∞ —Ç–∞ –≥—ñ—Ä–æ—Å–∫–æ–ø–∞
- **–ö–õ–Ü–Ñ–ù–¢** - –æ—Ç—Ä–∏–º—É—î –¥–∞–Ω—ñ —Ç–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î —ó—Ö –¥–ª—è ML-–ø—Ä–æ–≥–Ω–æ–∑—É–≤–∞–Ω–Ω—è –∞–±–æ –∑–±–æ—Ä—É –¥–∞—Ç–∞—Å–µ—Ç—É

---

## üîµ –°–ï–†–í–ï–† (ServerActivity.kt)

### üìç –†–æ–∑—Ç–∞—à—É–≤–∞–Ω–Ω—è:

**–§–∞–π–ª:** `app/src/main/java/dev/matsyshyn/lab5ml/ServerActivity.kt`

### üéØ –§—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ—Å—Ç—å:

1. **–ó–±—ñ—Ä –¥–∞–Ω–∏—Ö –∑ —Å–µ–Ω—Å–æ—Ä—ñ–≤** (—Ä—è–¥–∫–∏ 34-41, 197-204)

   - –ê–∫—Å–µ–ª–µ—Ä–æ–º–µ—Ç—Ä: `ax, ay, az`
   - –ì—ñ—Ä–æ—Å–∫–æ–ø: `gx, gy, gz`
   - –†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è —Å–ª—É—Ö–∞—á—ñ–≤ –≤ `onResume()` (—Ä—è–¥–∫–∏ 264-268)

2. **–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è BLE GATT Server** (—Ä—è–¥–∫–∏ 79-95)

   - UUID —Å–µ—Ä–≤—ñ—Å—É: `12345678-1234-5678-1234-56789abcdef0`
   - UUID —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏: `12345678-1234-5678-1234-56789abcdef1`
   - –°—Ç–≤–æ—Ä–µ–Ω–Ω—è GATT —Å–µ—Ä–≤—ñ—Å—É –∑ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–æ—é –¥–ª—è notifications

3. **BLE Advertising** (—Ä—è–¥–∫–∏ 98-134)

   - –ó–∞–ø—É—Å–∫ —Ä–µ–∫–ª–∞–º–∏ —Å–µ—Ä–≤—ñ—Å—É –¥–ª—è –ø–æ—à—É–∫—É –∫–ª—ñ—î–Ω—Ç–∞–º–∏
   - –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î `BluetoothLeAdvertiser`
   - –†–µ–∂–∏–º: `ADVERTISE_MODE_LOW_LATENCY` (–Ω–∏–∑—å–∫–∞ –∑–∞—Ç—Ä–∏–º–∫–∞)

4. **–í—ñ–¥–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–∏—Ö** (—Ä—è–¥–∫–∏ 140-195)

   - –¶–∏–∫–ª –≤—ñ–¥–ø—Ä–∞–≤–∫–∏ –∫–æ–∂–Ω—ñ **100 –º—Å** (10 –ì—Ü) - —Ä—è–¥–æ–∫ 144
   - –§–æ—Ä–º–∞—Ç –¥–∞–Ω–∏—Ö: `"ax,ay,az,gx,gy,gz"` - —Ä—è–¥–æ–∫ 154
   - –í—ñ–¥–ø—Ä–∞–≤–∫–∞ —á–µ—Ä–µ–∑ `notifyCharacteristicChanged()` - —Ä—è–¥–æ–∫ 192
   - –í—ñ–¥–ø—Ä–∞–≤–ª—è—î –≤—Å—ñ–º –ø—ñ–¥–ø–∏—Å–∞–Ω–∏–º –ø—Ä–∏—Å—Ç—Ä–æ—è–º –∑ `registeredDevices`

5. **–û–±—Ä–æ–±–∫–∞ –ø—ñ–¥–∫–ª—é—á–µ–Ω—å** (—Ä—è–¥–∫–∏ 208-262)
   - `gattServerCallback` –æ–±—Ä–æ–±–ª—è—î:
     - –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è/–≤—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –ø—Ä–∏—Å—Ç—Ä–æ—ó–≤
     - –ü—ñ–¥–ø–∏—Å–∫—É –Ω–∞ notifications (—á–µ—Ä–µ–∑ descriptor write)
     - –ó–º—ñ–Ω—É MTU (Maximum Transmission Unit)

### üîë –ö–ª—é—á–æ–≤—ñ –º–µ—Ç–æ–¥–∏:

| –ú–µ—Ç–æ–¥                | –†—è–¥–∫–∏   | –û–ø–∏—Å                                      |
| -------------------- | ------- | ----------------------------------------- |
| `startServer()`      | 59-138  | –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è GATT —Å–µ—Ä–≤–µ—Ä–∞ —Ç–∞ advertising |
| `startSendingLoop()` | 140-149 | –ó–∞–ø—É—Å–∫ —Ü–∏–∫–ª—É –≤—ñ–¥–ø—Ä–∞–≤–∫–∏ –¥–∞–Ω–∏—Ö              |
| `sendData()`         | 152-195 | –í—ñ–¥–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–∏—Ö —Å–µ–Ω—Å–æ—Ä—ñ–≤ –∫–ª—ñ—î–Ω—Ç–∞–º         |
| `onSensorChanged()`  | 197-204 | –û–Ω–æ–≤–ª–µ–Ω–Ω—è –∑–Ω–∞—á–µ–Ω—å —Å–µ–Ω—Å–æ—Ä—ñ–≤                |
| `gattServerCallback` | 208-262 | –û–±—Ä–æ–±–∫–∞ –ø–æ–¥—ñ–π BLE (–ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è, –ø—ñ–¥–ø–∏—Å–∫–∞) |

---

## üü¢ –ö–õ–Ü–Ñ–ù–¢ (ClientActivity.kt + BluetoothDataManager.kt)

### üìç –†–æ–∑—Ç–∞—à—É–≤–∞–Ω–Ω—è:

- **ClientActivity.kt:** `app/src/main/java/dev/matsyshyn/lab5ml/ClientActivity.kt`
- **BluetoothDataManager.kt:** `app/src/main/java/dev/matsyshyn/lab5ml/BluetoothDataManager.kt`

### üéØ –§—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ—Å—Ç—å:

#### ClientActivity.kt:

- **UI –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä** –∑ –≤–∫–ª–∞–¥–∫–∞–º–∏ (ViewPager2)
- –î–≤—ñ –≤–∫–ª–∞–¥–∫–∏: "Collector" —Ç–∞ "Prediction"
- –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î `ClientPagerAdapter` –¥–ª—è —Ñ—Ä–∞–≥–º–µ–Ω—Ç—ñ–≤

#### BluetoothDataManager.kt:

1. **–°–∫–∞–Ω—É–≤–∞–Ω–Ω—è —Å–µ—Ä–≤–µ—Ä–∞** (—Ä—è–¥–∫–∏ 32-84)

   - –ü–æ—à—É–∫ –ø—Ä–∏—Å—Ç—Ä–æ—é –∑ UUID —Å–µ—Ä–≤—ñ—Å—É: `12345678-1234-5678-1234-56789abcdef0`
   - –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î `ScanFilter` –¥–ª—è —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—ó
   - –¢–∞–π–º–∞—É—Ç —Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è: 15 —Å–µ–∫—É–Ω–¥

2. **–ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ —Å–µ—Ä–≤–µ—Ä–∞** (—Ä—è–¥–∫–∏ 86-135)

   - –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è —á–µ—Ä–µ–∑ `connectGatt()`
   - –í—ñ–¥–∫—Ä–∏—Ç—Ç—è —Å–µ—Ä–≤—ñ—Å—ñ–≤ —á–µ—Ä–µ–∑ `discoverServices()`
   - –ó–∞–ø–∏—Ç MTU (512 –±–∞–π—Ç) –¥–ª—è –±—ñ–ª—å—à–∏—Ö –ø–∞–∫–µ—Ç—ñ–≤

3. **–ü—ñ–¥–ø–∏—Å–∫–∞ –Ω–∞ notifications** (—Ä—è–¥–∫–∏ 123-129)

   - –£–≤—ñ–º–∫–Ω–µ–Ω–Ω—è notifications —á–µ—Ä–µ–∑ descriptor
   - UUID descriptor: `00002902-0000-1000-8000-00805f9b34fb`
   - –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è `ENABLE_NOTIFICATION_VALUE`

4. **–û—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö** (—Ä—è–¥–∫–∏ 131-134)
   - Callback `onCharacteristicChanged()` –æ—Ç—Ä–∏–º—É—î –¥–∞–Ω—ñ
   - –í–∏–∫–ª–∏–∫–∞—î `onDataReceived` callback –∑ —Ä—è–¥–∫–æ–º –¥–∞–Ω–∏—Ö
   - –§–æ—Ä–º–∞—Ç: `"ax,ay,az,gx,gy,gz"`

### üîë –ö–ª—é—á–æ–≤—ñ –º–µ—Ç–æ–¥–∏:

| –ú–µ—Ç–æ–¥                       | –†—è–¥–∫–∏   | –û–ø–∏—Å                                     |
| --------------------------- | ------- | ---------------------------------------- |
| `startScan()`               | 32-84   | –ü–æ—á–∞—Ç–æ–∫ —Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è BLE –ø—Ä–∏—Å—Ç—Ä–æ—ó–≤         |
| `gattCallback`              | 86-135  | –û–±—Ä–æ–±–∫–∞ –ø–æ–¥—ñ–π GATT (–ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è, –¥–∞–Ω—ñ)   |
| `onCharacteristicChanged()` | 131-134 | –û—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö –≤—ñ–¥ —Å–µ—Ä–≤–µ—Ä–∞              |
| `stop()`                    | 137-145 | –ó—É–ø–∏–Ω–∫–∞ —Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è —Ç–∞ –∑–∞–∫—Ä–∏—Ç—Ç—è –∑'—î–¥–Ω–∞–Ω–Ω—è |

---

## üîÑ –ü–†–û–¢–û–ö–û–õ –í–ó–ê–Ñ–ú–û–î–Ü–á

### 1. –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è:

```
–°–ï–†–í–ï–†: startServer()
  ‚Üí –°—Ç–≤–æ—Ä—é—î GATT —Å–µ—Ä–≤—ñ—Å
  ‚Üí –ó–∞–ø—É—Å–∫–∞—î BLE Advertising
  ‚Üí –†–µ—î—Å—Ç—Ä—É—î —Å–ª—É—Ö–∞—á—ñ–≤ —Å–µ–Ω—Å–æ—Ä—ñ–≤

–ö–õ–Ü–Ñ–ù–¢: startScan()
  ‚Üí –°–∫–∞–Ω—É—î BLE –ø—Ä–∏—Å—Ç—Ä–æ—ó –∑ UUID —Å–µ—Ä–≤—ñ—Å—É
  ‚Üí –ó–Ω–∞—Ö–æ–¥–∏—Ç—å —Å–µ—Ä–≤–µ—Ä
```

### 2. –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è:

```
–ö–õ–Ü–Ñ–ù–¢: connectGatt()
  ‚Üí –ü—ñ–¥–∫–ª—é—á–∞—î—Ç—å—Å—è –¥–æ —Å–µ—Ä–≤–µ—Ä–∞
  ‚Üí discoverServices()
  ‚Üí requestMtu(512)
  ‚Üí subscribeToNotifications()
```

### 3. –ü–µ—Ä–µ–¥–∞—á–∞ –¥–∞–Ω–∏—Ö:

```
–°–ï–†–í–ï–†: onSensorChanged()
  ‚Üí –û–Ω–æ–≤–ª—é—î ax,ay,az,gx,gy,gz
  ‚Üí sendData() –∫–æ–∂–Ω—ñ 100–º—Å
  ‚Üí notifyCharacteristicChanged()

–ö–õ–Ü–Ñ–ù–¢: onCharacteristicChanged()
  ‚Üí –û—Ç—Ä–∏–º—É—î —Ä—è–¥–æ–∫ "ax,ay,az,gx,gy,gz"
  ‚Üí –í–∏–∫–ª–∏–∫–∞—î onDataReceived callback
  ‚Üí CollectorFragment/PredictionFragment –æ–±—Ä–æ–±–ª—è—é—Ç—å –¥–∞–Ω—ñ
```

---

## üìä –í–ò–ö–û–†–ò–°–¢–ê–ù–ù–Ø –î–ê–ù–ò–•

### CollectorFragment:

- –û—Ç—Ä–∏–º—É—î –¥–∞–Ω—ñ —á–µ—Ä–µ–∑ `BluetoothDataManager.onDataReceived`
- –ó–±–µ—Ä—ñ–≥–∞—î –≤ –±—É—Ñ–µ—Ä –∑ –º—ñ—Ç–∫–æ—é –∫–ª–∞—Å—É
- –ó–∞–ø–∏—Å—É—î –≤ CSV —Ñ–∞–π–ª

### PredictionFragment:

- –û—Ç—Ä–∏–º—É—î –¥–∞–Ω—ñ —á–µ—Ä–µ–∑ `BluetoothDataManager.onDataReceived`
- –ù–∞–∫–æ–ø–∏—á—É—î –≤ sliding window (20 –∑–∞–º—ñ—Ä—ñ–≤)
- –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î `ActivityClassifier` –¥–ª—è ML-–ø—Ä–æ–≥–Ω–æ–∑—É–≤–∞–Ω–Ω—è

---

## üîß –¢–ï–•–ù–Ü–ß–ù–Ü –î–ï–¢–ê–õ–Ü

### UUID:

- **Service UUID:** `12345678-1234-5678-1234-56789abcdef0`
- **Characteristic UUID:** `12345678-1234-5678-1234-56789abcdef1`
- **Descriptor UUID (CCCD):** `00002902-0000-1000-8000-00805f9b34fb` (—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∏–π)

### –ß–∞—Å—Ç–æ—Ç–∞ –ø–µ—Ä–µ–¥–∞—á—ñ:

- **10 –ì—Ü** (–∫–æ–∂–Ω—ñ 100 –º—Å) - —Ä—è–¥–æ–∫ 144 –≤ ServerActivity.kt

### –§–æ—Ä–º–∞—Ç –¥–∞–Ω–∏—Ö:

- –†—è–¥–æ–∫: `"ax,ay,az,gx,gy,gz"`
- –ü—Ä–∏–∫–ª–∞–¥: `"0.12,-9.81,0.45,0.01,0.02,-0.01"`

### MTU:

- –ó–∞–ø–∏—Ç—É—î—Ç—å—Å—è **512 –±–∞–π—Ç** –¥–ª—è –±—ñ–ª—å—à–∏—Ö –ø–∞–∫–µ—Ç—ñ–≤
- –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∏–π MTU: 23 –±–∞–π—Ç–∏

---

## üìÅ –°–¢–†–£–ö–¢–£–†–ê –§–ê–ô–õ–Ü–í

```
app/src/main/java/dev/matsyshyn/lab5ml/
‚îú‚îÄ‚îÄ ServerActivity.kt          ‚Üê –°–ï–†–í–ï–† (–≤—ñ–¥–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–∏—Ö)
‚îú‚îÄ‚îÄ ClientActivity.kt          ‚Üê –ö–õ–Ü–Ñ–ù–¢ (UI –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä)
‚îú‚îÄ‚îÄ BluetoothDataManager.kt    ‚Üê –ö–õ–Ü–Ñ–ù–¢ (BLE –ª–æ–≥—ñ–∫–∞)
‚îú‚îÄ‚îÄ CollectorFragment.kt      ‚Üê –ó–±—ñ—Ä –¥–∞—Ç–∞—Å–µ—Ç—É
‚îú‚îÄ‚îÄ PredictionFragment.kt      ‚Üê ML-–ø—Ä–æ–≥–Ω–æ–∑—É–≤–∞–Ω–Ω—è
‚îî‚îÄ‚îÄ ActivityClassifier.kt     ‚Üê ML-–º–æ–¥–µ–ª—å
```

---

## ‚úÖ –ü–ï–†–ï–í–Ü–†–ö–ê –†–û–ë–û–¢–ò

1. **–ó–∞–ø—É—Å—Ç–∏—Ç–∏ ServerActivity** –Ω–∞ –æ–¥–Ω–æ–º—É –ø—Ä–∏—Å—Ç—Ä–æ—ó

   - –ú–∞—î –ø–æ–∫–∞–∑–∞—Ç–∏ "üì° Bluetooth LE Advertising started!"

2. **–ó–∞–ø—É—Å—Ç–∏—Ç–∏ ClientActivity** –Ω–∞ —ñ–Ω—à–æ–º—É –ø—Ä–∏—Å—Ç—Ä–æ—ó

   - –ù–∞—Ç–∏—Å–Ω—É—Ç–∏ –∫–Ω–æ–ø–∫—É —Å–∫–∞–Ω—É–≤–∞–Ω–Ω—è
   - –ú–∞—î –∑–Ω–∞–π—Ç–∏ —Å–µ—Ä–≤–µ—Ä —Ç–∞ –ø—ñ–¥–∫–ª—é—á–∏—Ç–∏—Å—è

3. **–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –ø–µ—Ä–µ–¥–∞—á—É –¥–∞–Ω–∏—Ö:**
   - –ù–∞ —Å–µ—Ä–≤–µ—Ä—ñ: –ø–æ–∫–∞–∑—É—î "üì° Broadcasting to 1 device(s)"
   - –ù–∞ –∫–ª—ñ—î–Ω—Ç—ñ: –¥–∞–Ω—ñ –∑'—è–≤–ª—è—é—Ç—å—Å—è –≤ Collector/Prediction

---

## üéì –í–Ü–î–ü–û–í–Ü–î–Ü –ù–ê –ü–ò–¢–ê–ù–ù–Ø –í–ò–ö–õ–ê–î–ê–ß–ê

**Q: –î–µ —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ —Å–µ—Ä–≤–µ—Ä?**
A: `ServerActivity.kt` - —Ä—è–¥–∫–∏ 23-309. –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î `BluetoothGattServer` —Ç–∞ `BluetoothLeAdvertiser`.

**Q: –î–µ —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ –∫–ª—ñ—î–Ω—Ç?**
A: `BluetoothDataManager.kt` - —Ä—è–¥–∫–∏ 13-146. –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î `BluetoothGatt` –¥–ª—è –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è —Ç–∞ –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö.

**Q: –Ø–∫ –ø—Ä–∞—Ü—é—î –ø–µ—Ä–µ–¥–∞—á–∞ –¥–∞–Ω–∏—Ö?**
A: –°–µ—Ä–≤–µ—Ä –≤—ñ–¥–ø—Ä–∞–≤–ª—è—î –¥–∞–Ω—ñ —á–µ—Ä–µ–∑ `notifyCharacteristicChanged()` –∫–æ–∂–Ω—ñ 100–º—Å. –ö–ª—ñ—î–Ω—Ç –æ—Ç—Ä–∏–º—É—î —á–µ—Ä–µ–∑ `onCharacteristicChanged()` callback.

**Q: –Ø–∫–∏–π –ø—Ä–æ—Ç–æ–∫–æ–ª –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è?**
A: Bluetooth Low Energy (BLE) –∑ GATT –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–º. UUID —Å–µ—Ä–≤—ñ—Å—É: `12345678-1234-5678-1234-56789abcdef0`.

**Q: –Ø–∫–∞ —á–∞—Å—Ç–æ—Ç–∞ –ø–µ—Ä–µ–¥–∞—á—ñ?**
A: 10 –ì—Ü (–∫–æ–∂–Ω—ñ 100 –º—Å) - –¥–æ—Å—Ç–∞—Ç–Ω—å–æ –¥–ª—è ML –º–æ–¥–µ–ª—ñ –∑ –≤—ñ–∫–Ω–æ–º 20 –∑–∞–º—ñ—Ä—ñ–≤.


