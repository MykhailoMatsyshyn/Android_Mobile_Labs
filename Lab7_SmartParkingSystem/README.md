# Smart Parking System - Лабораторна робота №7

Система моніторингу паркування автомобілів з синхронізацією даних між мобільним пристроєм, локальною БД та хмарою.

## Компоненти системи

### 1. Генератор емульованих даних сенсорів

**⚠️ Окремий компонент!** Знаходиться в `sensor-api-server/` і запускається окремо.

- REST API сервер на Python Flask
- Генерує реалістичні дані з трендами, шумом та аномаліями
- Надає дані через HTTP API
- Сенсори:
  - Датчики наявності авто на місцях: 0-1
  - Кількість вільних місць: 0-100
  - Якість повітря (CO, NOx): 0-500 ppm
  - Температура: -10 до 40°C

**Альтернатива:** Локальний генератор всередині Android додатку (для тестування без сервера)

### 2. Хмарний сервіс (Firebase Firestore)

- Зберігання даних сенсорів з часовою позначкою
- Синхронізація між пристроями
- Обробка перервного з'єднання

### 3. Емулятор керування пристроями

- Панелі з напрямками: вкл/викл, яскравість
- Вентилятор: швидкість (1-3)
- Система обігріву: вкл/викл, потужність (1-2)

### 4. Мобільний додаток

- Відображення даних в реальному часі з графіками
- Статистика (кількість записів, середнє, медіана, тренд)
- Локальне збереження (Room/SQLite)
- Синхронізація з Firebase
- Ручне керування пристроями
- Автоматичні правила керування

## Правила автоматизації

1. Якщо вільних місць < 10 → включити панелі з напрямками
2. Якщо CO > 300 ppm → максимально включити вентиляцію
3. Якщо T < -5°C → включити обігрів в'їзду

## Налаштування Firebase

1. Створіть проект у [Firebase Console](https://console.firebase.google.com/)
2. Додайте Android додаток до проекту
3. Завантажте файл `google-services.json` з Firebase Console
4. Розмістіть файл у `app/` директорію
5. Увімкніть Firestore Database у Firebase Console

## Залежності

Проект використовує:

- Room для локальної бази даних
- Firebase Firestore для хмарного зберігання
- MPAndroidChart для графіків
- Navigation Component для навігації
- Coroutines для асинхронної роботи
- ViewBinding для роботи з макетами

## Структура проекту

```
SmartParkingSystem/
├── sensor-api-server/          # ⚠️ ОКРЕМИЙ КОМПОНЕНТ - REST API сервер
│   ├── sensor_api_server.py    # Python Flask сервер
│   ├── requirements_api.txt    # Python залежності
│   └── README.md              # Інструкції для сервера
│
└── app/                        # Android додаток
    └── src/main/java/dev/matsyshyn/smartparkingsystem/
        ├── data/
        │   ├── api/            # REST API клієнт
        │   ├── database/       # Room база даних
        │   ├── firebase/       # Firebase сервіс
        │   ├── device/         # Керування пристроями
        │   ├── sensor/         # Локальний генератор (fallback)
        │   ├── repository/     # Репозиторій для роботи з даними
        │   └── model/          # Моделі даних
        ├── ui/
        │   ├── monitoring/     # Екран моніторингу
        │   ├── devicecontrol/  # Екран керування пристроями
        │   ├── rules/          # Екран правил автоматизації
        │   └── viewmodel/      # ViewModels
        └── ParkingApplication.kt
```

## Використання

### Запуск API сервера (окремо!)

1. Перейдіть в директорію `sensor-api-server/`
2. Встановіть залежності: `pip install -r requirements_api.txt`
3. Запустіть сервер: `python sensor_api_server.py`
4. Сервер працює на `http://localhost:5000`

**Детальні інструкції:** Дивіться `sensor-api-server/README.md`

### Запуск Android додатку

1. Налаштуйте Firebase (дивіться `FIREBASE_SETUP.md`)
2. Налаштуйте підключення до API (дивіться `API_INTEGRATION.md`)
3. Запустіть додаток
4. На екрані "Моніторинг" натисніть "Почати генерацію"
5. Переглядайте графіки та статистику
6. На екрані "Керування пристроями" керуйте пристроями вручну
7. На екрані "Правила автоматизації" налаштуйте правила
8. Натисніть "Синхронізувати" для синхронізації з хмарою

## Примітки

- Додаток працює офлайн з локальним кешуванням
- Синхронізація відбувається автоматично при наявності інтернету
- Правила автоматизації оцінюються при отриманні нових даних сенсорів
